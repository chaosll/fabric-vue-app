# drawPage 目录 - AI绘图生成模块

## 简介

drawPage目录是一个基于Vue.js的AI绘图生成模块，支持通过AI技术将产品图与背景场景自然融合，生成高质量的产品宣传图片。该模块主要提供以下功能：

1. **AI创意生图**：用户可以选择产品图、生成尺寸、画面风格，由AI智能生成背景场景并自然融合产品图。
2. **固定场景生图**：用户可以选择预设的固定场景，将产品图放入其中生成宣传图片。
3. **图片编辑**：支持对生成后的图片进行调整，包括产品大小、位置、旋转、翻转等操作。

## 文件结构及功能说明

### 1. `index.vue`

**主功能**：绘图页面的主入口组件，包含整个绘图流程的UI和交互逻辑。

**关键特性**：
- 提供三种生图模式：AI创意生图、AI定制设计、固定场景生图
- 支持选择产品图、图片尺寸、画面风格等参数
- 封装了AI生成背景图和自然融合的完整流程
- 包含多种筛选和预览功能

**主要组件结构**：
- AI创意生图标签页：用户可以选择产品图、尺寸、风格，由AI创建背景场景
- AI定制设计标签页（即将上线）
- 固定场景生图标签页：用户可以选择产品图和预设场景进行生图

### 2. `PreviewGrabbing.vue`

**主功能**：图片预览和交互编辑组件，基于Fabric.js实现对图片的各种调整功能。

**关键特性**：
- 支持产品图和背景图的组合预览
- 实现产品图的拖拽、缩放、旋转、翻转等操作
- 提供交互式控制点进行直观的图片编辑
- 支持缩放比例的精确控制

**主要技术点**：
- 使用Fabric.js作为Canvas操作库
- 自定义控制点实现特殊交互功能
- 触摸屏和鼠标双重交互支持
- 维护图片变换状态并实时反馈

### 3. `GeneratePreview.vue`

**主功能**：生成预览组件，显示AI生成的场景预览和操作界面。

**关键特性**：
- 显示AI生成过程中的加载状态
- 预览生成完成的图片并支持编辑
- 提供缩放工具和操作提示
- 支持多张生成图片的切换和选择

**主要交互流程**：
1. 显示生成状态（生成中/已完成/未开始）
2. 完成后展示预览编辑界面
3. 提供缩放工具和操作说明
4. 支持生成多张图片并进行选择

## 核心工作流程

### AI创意生图流程

1. 用户选择产品图
2. 选择图片生成尺寸
3. 选择画面风格
4. 点击"生成背景图"按钮，AI生成背景场景
5. 点击"AI生成自然效果"按钮，AI将产品图与背景融合
6. 在预览界面调整产品位置、大小、角度等
7. 确认生成结果并保存/导出

### 固定场景生图流程

1. 用户选择产品图
2. 浏览并选择预设的背景场景
3. 可根据类型、角度等筛选场景
4. 点击生成按钮，得到产品与场景的合成结果
5. 在预览界面调整产品位置和大小
6. 确认生成结果并保存/导出

## 技术架构

- **前端框架**：Vue.js
- **状态管理**：使用Store模式管理应用状态
- **Canvas操作**：基于Fabric.js实现图片编辑功能
- **UI组件**：使用MD组件库构建界面
- **通信方式**：与父窗口通过postMessage进行通信

## 开发注意事项

1. 组件间有较多状态依赖，修改需谨慎考虑影响范围
2. 图片生成过程涉及到与后端API交互，需关注网络请求状态处理
3. Canvas操作相关代码较为复杂，修改时建议充分测试
4. 部分功能正在开发中（如"AI定制设计"），注意版本控制

## 未来扩展计划

1. 完善"AI定制设计"功能
2. 增加更多图片编辑选项
3. 优化生成图片质量和效率
4. 增强用户交互体验和操作引导
